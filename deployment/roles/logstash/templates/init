# {{ ansible_managed }}
#
# logstash - agent instance
#

description "logstash agent"

start on virtual-filesystems
stop on runlevel [06]

respawn
respawn limit 5 30

limit nofile 65550 65550
setuid logstash
setgid logstash

env JAVA_OPTS='-Xms{{ logstash.initial_java_heap }} -Xmx{{ logstash.maximum_java_heap }}'
chdir /var/lib/logstash
console log

script
  exec java $JAVA_OPTS -jar {{ logstash.path }}/logstash-{{ logstash.version }}-flatjar.jar agent -f /etc/logstash/logstash.conf --log /var/log/logstash/logstash.log
end script

